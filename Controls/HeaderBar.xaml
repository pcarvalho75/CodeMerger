<UserControl x:Class="CodeMerger.Controls.HeaderBar"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
    <Border Background="{StaticResource BackgroundCard}" Padding="24,16">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="220"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Logo -->
            <StackPanel Grid.Column="0" Orientation="Horizontal" VerticalAlignment="Center" Margin="0,0,24,0">
                <Border Background="{StaticResource AccentPrimary}" CornerRadius="8" Padding="8" Margin="0,0,12,0">
                    <Path Data="M 12,3 L 20,7.5 L 20,16.5 L 12,21 L 4,16.5 L 4,7.5 Z M 12,8 L 8,10.5 L 8,15.5 L 12,18 L 16,15.5 L 16,10.5 Z"
                          Fill="White" Stretch="Uniform" Width="20" Height="20"/>
                </Border>
                <TextBlock Text="CodeMerger" FontSize="22" FontWeight="Bold" Foreground="{StaticResource TextPrimary}" VerticalAlignment="Center"/>
                <TextBlock x:Name="versionText" FontSize="10" Foreground="{StaticResource TextSecondary}" VerticalAlignment="Bottom" Margin="6,0,0,3"/>
            </StackPanel>

            <!-- Project Selection -->
            <TextBlock Grid.Column="1" Text="Project" Foreground="{StaticResource TextSecondary}" VerticalAlignment="Center" Margin="0,0,12,0" FontSize="13"/>
            <ComboBox x:Name="projectComboBox" Grid.Column="2" DisplayMemberPath="Name" VerticalAlignment="Center"
                      SelectionChanged="ProjectComboBox_SelectionChanged" Style="{StaticResource ModernComboBox}"/>

            <StackPanel Grid.Column="3" Orientation="Horizontal" Margin="12,0,0,0">
                <Button x:Name="newWorkspaceButton" Content="ï¼‹ New" Click="NewWorkspace_Click" Style="{StaticResource ModernButton}" Margin="0,0,6,0"/>
                <Button x:Name="renameWorkspaceButton" Content="âœŽ Rename" Click="RenameWorkspace_Click" Style="{StaticResource ModernButton}" Margin="0,0,6,0"/>
                <Button x:Name="deleteWorkspaceButton" Content="ðŸ—‘ Delete" Click="DeleteWorkspace_Click" Style="{StaticResource ModernButton}"/>
            </StackPanel>

            <!-- Connection Status -->
            <Border Grid.Column="5" Background="{StaticResource BackgroundDark}" CornerRadius="20" Padding="16,8" VerticalAlignment="Center">
                <StackPanel Orientation="Horizontal">
                    <Ellipse x:Name="connectionIndicator" Width="10" Height="10" Fill="#555" Margin="0,0,6,0" VerticalAlignment="Center"/>
                    <TextBlock Text="Claude" Foreground="{StaticResource TextSecondary}" FontSize="11" VerticalAlignment="Center" Margin="0,0,12,0"/>
                    <Ellipse x:Name="chatGptConnectionIndicator" Width="10" Height="10" Fill="#555" Margin="0,0,6,0" VerticalAlignment="Center"/>
                    <TextBlock Text="ChatGPT" Foreground="{StaticResource TextSecondary}" FontSize="11" VerticalAlignment="Center" Margin="0,0,12,0"/>
                    <TextBlock x:Name="connectionStatusText" Text="Waiting..." Foreground="{StaticResource TextSecondary}" FontSize="11" VerticalAlignment="Center"/>
                    <Button x:Name="stopServerButton" Content="â¹ Stop" Click="StopServer_Click"
                            Style="{StaticResource SmallLinkButton}" Margin="12,0,0,0" Visibility="Collapsed"
                            ToolTip="Stop MCP server to allow recompilation"/>
                </StackPanel>
            </Border>
        </Grid>
    </Border>
</UserControl>
